// Function แสดงผลหน้า
function showPage(pageId) {
    document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
    const target = document.getElementById(pageId);
    if(target) target.classList.add('active');
    document.getElementById('mobile-menu').classList.add('hidden');
    window.scrollTo(0,0);
}

// Function ค้นหาและกรอง
function drawJobs(list) {
    const container = document.getElementById('job-container');
    container.innerHTML = list.map(job => `
        <div class="bg-white p-6 rounded-2xl shadow-lg hover:-translate-y-2 transition cursor-pointer" onclick="openModal(${job.id})">
            <img src="${job.image}" class="w-full h-40 object-cover rounded-xl mb-4">
            <span class="text-xs font-bold text-theme-500">${job.category}</span>
            <h3 class="text-lg font-bold mb-2">${job.title}</h3>
            <p class="text-sm text-slate-500 mb-4">${job.desc}</p>
            <div class="border-t pt-3 flex justify-between items-center">
                <span class="text-theme-600 font-bold text-sm">${job.salary}</span>
                <i class="fa-solid fa-arrow-right text-slate-300"></i>
            </div>
        </div>
    `).join('');
}

function searchJobs() {
    const text = document.getElementById('search-input').value.toLowerCase();
    const filtered = jobsData.filter(j => j.title.toLowerCase().includes(text) || j.category.toLowerCase().includes(text));
    drawJobs(filtered);
}

function filterJobs(cat) {
    const filtered = cat === 'all' ? jobsData : jobsData.filter(j => j.category.includes(cat));
    drawJobs(filtered);
}

// Modal Logic
function openModal(id) {
    const job = jobsData.find(j => j.id === id);
    const modal = document.getElementById('job-modal');
    document.getElementById('modal-content').innerHTML = `
        <h2 class="text-3xl font-bold mb-4">${job.title}</h2>
        <p class="text-slate-600 mb-6">${job.long_desc}</p>
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-slate-50 p-4 rounded-xl"><strong>เงินเดือน:</strong> ${job.salary}</div>
            <div class="bg-slate-50 p-4 rounded-xl"><strong>หมวดหมู่:</strong> ${job.category}</div>
        </div>
        <h4 class="font-bold mb-2">ทักษะที่ต้องมี:</h4>
        <div class="flex gap-2">${job.skills.map(s => `<span class="bg-theme-100 text-theme-700 px-3 py-1 rounded-full text-sm">${s}</span>`).join('')}</div>
    `;
    modal.classList.remove('hidden');
    modal.classList.add('flex');
}

function closeModal() {
    const modal = document.getElementById('job-modal');
    modal.classList.add('hidden');
    modal.classList.remove('flex');
}

// Typing Effect
let wordIdx = 0;
const words = ["AI & Data", "Software", "Creative Business"];
function type() {
    const el = document.getElementById('typing-text');
    if(!el) return;
    el.innerText = words[wordIdx];
    wordIdx = (wordIdx + 1) % words.length;
    setTimeout(type, 2000);
}

// Initial
window.onload = () => {
    drawJobs(jobsData);
    type();
};